<!doctype html>

<meta charset="UTF-8">

<style>
#conteudo {
    margin: 50px auto;
    width: 960px;
    text-align: center;
}

td {
    text-align: center;
    min-width: 90px;
}

td {
    padding: 10px 0;
}

tbody tr:hover {
    background-color: #f5f5f5;
}

#tabela {
    margin: 0 auto;
}

thead td {
    cursor: pointer;
    user-select: none;
}

</style>

<title>Table Top - DigitalDesk</title>

<div id="conteudo">
    <h1>Ticket to ride</h1>

    <table id="tabela">
        <thead>
            <tr>
                <td ordenacao="nome">Jogador</td>
                <td ordenacao="jogos">Jogos</td>
                <td ordenacao="vitorias">Vit√≥rias</td>
                <td ordenacao="aproveitamento">Aproveitamento</td>
            </tr>
        </thead>
        <tbody id="corpo">
        </tbody>
    </table>
</div>

<script>
const aproveitamento = ({ jogos, vitorias }) => vitorias / jogos

const dados = [
    {
        nome: 'Gabriel',
        jogos: 8,
        vitorias: 2
    },
    {
        nome: 'Fred',
        jogos: 1,
        vitorias: 1
    }
].map(x => ({ ...x, aproveitamento: aproveitamento(x) * 100 }))

const ordenador = attr => (a, b) => typeof a[attr] === 'string'
                                    ? a[attr] > b[attr]
                                    : a[attr] < b[attr]

const linha = celulas => {
    const tr = document.createElement('tr')

    celulas.map(x => {
        const td = document.createElement('td')
        td.textContent = x
        return td
    }).forEach(tr.appendChild.bind(tr))

    return tr
}

const popularTabela = dados => {
    const tbody = document.getElementById('corpo')

    for (const x of dados) {
        tbody.appendChild(linha([
            x.nome,
            x.jogos,
            x.vitorias,
            x.aproveitamento.toFixed(2) + '%'
        ]))
    }
}

const limparTabela = () => {
    const tbody = document.getElementById('corpo')
    tbody.parentNode.replaceChild(tbody.cloneNode(false), tbody)
}

document.querySelectorAll('thead td').forEach(td => {
    td.addEventListener('click', () => {
        limparTabela()
        const prop = td.getAttribute('ordenacao')
        popularTabela(dados.sort(ordenador(prop)))
    })
})

window.addEventListener('load', () => {
    popularTabela(dados.sort(ordenador('vitorias')))
})
</script>